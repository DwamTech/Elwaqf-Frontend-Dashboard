# ๐ฆ ุชูุฑูุฑ ููุฒุฉ ุงููุณุฎ ุงูุงุญุชูุงุทู (Backup Feature Documentation)

> **ุชุงุฑูุฎ ุงูุชูุฑูุฑ:** 2026-01-05  
> **ุงููุดุฑูุน:** Dwam CMS - FinalBackVersion  
> **ุงูููุชุจุฉ ุงููุณุชุฎุฏูุฉ:** `spatie/laravel-backup`

---

## ๐ ููุฑุณ ุงููุญุชููุงุช

1. [ูุธุฑุฉ ุนุงูุฉ](#-ูุธุฑุฉ-ุนุงูุฉ)
2. [ุงููููู ุงูุจุฑูุฌู](#-ุงููููู-ุงูุจุฑูุฌู)
3. [ุงูุนูููุงุช ุงููุชุงุญุฉ](#-ุงูุนูููุงุช-ุงููุชุงุญุฉ)
   - [ุชูููุฏ ูุณุฎุฉ ุงุญุชูุงุทูุฉ (Create)](#1๏ธโฃ-ุชูููุฏ-ูุณุฎุฉ-ุงุญุชูุงุทูุฉ-create)
   - [ุนุฑุถ ุงููุณุฎ ุงููุชุงุญุฉ (List)](#2๏ธโฃ-ุนุฑุถ-ุงููุณุฎ-ุงููุชุงุญุฉ-list)
   - [ุชุญููู ูุณุฎุฉ ุงุญุชูุงุทูุฉ (Download)](#3๏ธโฃ-ุชุญููู-ูุณุฎุฉ-ุงุญุชูุงุทูุฉ-download)
   - [ุฑูุน ูุณุฎุฉ ุงุญุชูุงุทูุฉ (Upload)](#4๏ธโฃ-ุฑูุน-ูุณุฎุฉ-ุงุญุชูุงุทูุฉ-upload)
   - [ุงุณุชุฑุฌุงุน ูุณุฎุฉ ุงุญุชูุงุทูุฉ (Restore)](#5๏ธโฃ-ุงุณุชุฑุฌุงุน-ูุณุฎุฉ-ุงุญุชูุงุทูุฉ-restore)
   - [ุนุฑุถ ุงูุณุฌู (History)](#6๏ธโฃ-ุนุฑุถ-ุงูุณุฌู-history)
4. [ุงูุฌุฏููุฉ ุงูุชููุงุฆูุฉ](#-ุงูุฌุฏููุฉ-ุงูุชููุงุฆูุฉ)
5. [ุฅุนุฏุงุฏุงุช ุงูู Backup](#-ุฅุนุฏุงุฏุงุช-ุงูู-backup)
6. [ูุธุงู ุชุณุฌูู ุงูุฃุญุฏุงุซ](#-ูุธุงู-ุชุณุฌูู-ุงูุฃุญุฏุงุซ)
7. [ูููุฐุฌ ูุงุนุฏุฉ ุงูุจูุงูุงุช](#-ูููุฐุฌ-ูุงุนุฏุฉ-ุงูุจูุงูุงุช)
8. [ููุงุญุธุงุช ูุชูุตูุงุช](#-ููุงุญุธุงุช-ูุชูุตูุงุช)

---

## ๐ฏ ูุธุฑุฉ ุนุงูุฉ

ูุธุงู ุงููุณุฎ ุงูุงุญุชูุงุทู ูู Dwam CMS ูููุฑ ุญูุงูุฉ ุดุงููุฉ ููุจูุงูุงุช ูู ุฎูุงู:

| ุงูููุฒุฉ | ุงููุตู |
|--------|-------|
| **ุงููุณุฎ ุงูุชููุงุฆู** | ูู 3 ุฃูุงู ุงูุณุงุนุฉ 2 ุตุจุงุญุงู |
| **ุงูุชูุธูู ุงูุชููุงุฆู** | ููููุงู ุงูุณุงุนุฉ 3 ุตุจุงุญุงู |
| **ุงููุฑุงูุจุฉ** | ููููุงู ุงูุณุงุนุฉ 4 ุตุจุงุญุงู |
| **ุงููุณุฎ ุงููุฏูู** | ุนูุฏ ุงูุทูุจ (Full ุฃู DB only) |
| **ุงูุงุณุชุฑุฌุงุน** | ุงุณุชุฑุฌุงุน ูุงูู ูุน ูุณุฎุฉ ููุงุฆูุฉ |

---

## ๐๏ธ ุงููููู ุงูุจุฑูุฌู

### ุงููููุงุช ุงูุฃุณุงุณูุฉ:

```
app/
โโโ Http/Controllers/
โ   โโโ BackupController.php          # Controller ุฑุฆูุณู (534 ุณุทุฑ)
โโโ Models/
โ   โโโ BackupHistory.php             # ูููุฐุฌ ุณุฌู ุงูุนูููุงุช
โโโ Listeners/
โ   โโโ BackupEventSubscriber.php     # ูุณุชูุน ุฃุญุฏุงุซ Spatie
โโโ Providers/
    โโโ AppServiceProvider.php        # ุชุณุฌูู ุงูู Subscriber

config/
โโโ backup.php                        # ุฅุนุฏุงุฏุงุช ุงูููุชุจุฉ (368 ุณุทุฑ)

routes/
โโโ api.php                           # ููุงุท ุงูููุงูุฉ API
โโโ console.php                       # ุงูุฌุฏููุฉ ุงูุชููุงุฆูุฉ

database/migrations/
โโโ 2025_12_22_131053_create_backup_histories_table.php
โโโ 2025_12_22_131717_update_backup_histories_enums.php

storage/app/
โโโ backup-temp/                      # ูููุงุช ูุคูุชุฉ
โโโ {APP_NAME}/                       # ูุฌูุฏ ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ
```

---

## ๐ง ุงูุนูููุงุช ุงููุชุงุญุฉ

### 1๏ธโฃ ุชูููุฏ ูุณุฎุฉ ุงุญุชูุงุทูุฉ (Create)

#### ุงููุนูููุงุช ุงูุฃุณุงุณูุฉ:

| ุงูุนูุตุฑ | ุงููููุฉ |
|--------|--------|
| **Endpoint** | `POST /api/backups/create` |
| **Authentication** | ูุทููุจ (Admin only) |
| **Controller Method** | `BackupController::create()` |
| **ุงูููู** | `app/Http/Controllers/BackupController.php:94-147` |

#### ุงููุนุงููุงุช (Parameters):

| ุงููุนุงูู | ุงูููุน | ุงูููู ุงููุณููุญุฉ | ุงูุงูุชุฑุงุถู | ุงููุตู |
|---------|-------|----------------|-----------|-------|
| `mode` | string | `full`, `db` | `full` | ููุน ุงููุณุฎุฉ |

#### ุฃูุถุงุน ุงููุณุฎ:

| ุงููุถุน | ุงููุญุชูู | ุงูุงุณุชุฎุฏุงู |
|-------|---------|-----------|
| **full** | ูุงุนุฏุฉ ุงูุจูุงูุงุช + `storage/app/public` | ูุณุฎุฉ ุดุงููุฉ |
| **db** | ูุงุนุฏุฉ ุงูุจูุงูุงุช ููุท | ูุณุฎุฉ ุณุฑูุนุฉ |

#### ูุซุงู ุงูุทูุจ:

```bash
curl -X POST "https://api.example.com/api/backups/create" \
  -H "Authorization: Bearer {token}" \
  -H "Content-Type: application/json" \
  -d '{"mode": "full"}'
```

#### ุงูุงุณุชุฌุงุจุฉ:

```json
{
  "success": true,
  "mode": "full",
  "message": "Backup process has been queued and will run in the background."
}
```

#### ุงูููุงุญุธุงุช:
- โ ุงูุนูููุฉ ุชุนูู ูู ุงูุฎูููุฉ (Queued) ุจุงุณุชุฎุฏุงู `Artisan::queue()`
- โ ูุชู ุชุณุฌูู ุงูุนูููุฉ ูู `backup_histories` ูุจู ุงูุจุฏุก
- โ๏ธ ูุฌุจ ุชุดุบูู Queue Worker ูุชูููุฐ ุงูุนูููุฉ

---

### 2๏ธโฃ ุนุฑุถ ุงููุณุฎ ุงููุชุงุญุฉ (List)

#### ุงููุนูููุงุช ุงูุฃุณุงุณูุฉ:

| ุงูุนูุตุฑ | ุงููููุฉ |
|--------|--------|
| **Endpoint** | `GET /api/backups` |
| **Authentication** | ูุทููุจ (Admin only) |
| **Controller Method** | `BackupController::index()` |
| **ุงูููู** | `app/Http/Controllers/BackupController.php:17-45` |

#### ูุซุงู ุงูุทูุจ:

```bash
curl -X GET "https://api.example.com/api/backups" \
  -H "Authorization: Bearer {token}"
```

#### ุงูุงุณุชุฌุงุจุฉ:

```json
[
  {
    "file_name": "2026-01-05-02-00-00.zip",
    "file_size": "125.45M",
    "created_at": "2026-01-05 02:00:15",
    "download_link": "https://api.example.com/api/backups/download?file_name=2026-01-05-02-00-00.zip"
  },
  {
    "file_name": "2026-01-02-02-00-00.zip",
    "file_size": "120.30M",
    "created_at": "2026-01-02 02:00:10",
    "download_link": "..."
  }
]
```

#### ุงูููุงุญุธุงุช:
- โ ูููู ุจุชุตููุฉ ุงููููุงุช ุจุงูุชุฏุงุฏ `.zip` ููุท
- โ ูุฑุชุจุฉ ูู ุงูุฃุญุฏุซ ููุฃูุฏู
- โ ุญุฌู ุงูููู ุจุตูุบุฉ ููุฑูุกุฉ (human readable)

---

### 3๏ธโฃ ุชุญููู ูุณุฎุฉ ุงุญุชูุงุทูุฉ (Download)

#### ุงููุนูููุงุช ุงูุฃุณุงุณูุฉ:

| ุงูุนูุตุฑ | ุงููููุฉ |
|--------|--------|
| **Endpoint** | `GET /api/backups/download` |
| **Route Name** | `backup.download` |
| **Authentication** | ูุทููุจ (Admin only) |
| **Controller Method** | `BackupController::download()` |
| **ุงูููู** | `app/Http/Controllers/BackupController.php:51-74` |

#### ุงููุนุงููุงุช (Parameters):

| ุงููุนุงูู | ุงูููุน | ูุทููุจ | ุงููุตู |
|---------|-------|-------|-------|
| `file_name` | string | โ | ุงุณู ููู ุงููุณุฎุฉ |

#### ูุซุงู ุงูุทูุจ:

```bash
curl -X GET "https://api.example.com/api/backups/download?file_name=2026-01-05-02-00-00.zip" \
  -H "Authorization: Bearer {token}" \
  -o backup.zip
```

#### ุงูุงุณุชุฌุงุจุงุช:

| ุงูุญุงูุฉ | ุงูููุฏ | ุงูุฑุณุงูุฉ |
|--------|-------|---------|
| ูุฌุงุญ | 200 | ููู ููุชุญููู |
| ุงุณู ูุงุฑุบ | 400 | `File name is required` |
| ุบูุฑ ููุฌูุฏ | 404 | `Backup file not found` |

#### ุงูููุงุญุธุงุช:
- โ ูุจุญุซ ุฃููุงู ูู ูุฌูุฏ `{APP_NAME}/`
- โ ูุจุญุซ ุซุงููุงู ูู ุฌุฐุฑ ุงูู storage
- โ ูุณุชุฎุฏู `response()->download()` ููุชุญููู ุงููุจุงุดุฑ

---

### 4๏ธโฃ ุฑูุน ูุณุฎุฉ ุงุญุชูุงุทูุฉ (Upload)

#### ุงููุนูููุงุช ุงูุฃุณุงุณูุฉ:

| ุงูุนูุตุฑ | ุงููููุฉ |
|--------|--------|
| **Endpoint** | `POST /api/backups/upload` |
| **Authentication** | ูุทููุจ (Admin only) |
| **Controller Method** | `BackupController::upload()` |
| **ุงูููู** | `app/Http/Controllers/BackupController.php:483-531` |

#### ุงููุนุงููุงุช (Parameters):

| ุงููุนุงูู | ุงูููุน | ูุทููุจ | ุงููุตู |
|---------|-------|-------|-------|
| `file` | file | โ | ููู zip ููุฑูุน |

#### ุงููููุฏ:

| ุงูููุฏ | ุงููููุฉ |
|-------|--------|
| ุงูุงูุชุฏุงุฏ ุงููุณููุญ | `.zip` ููุท |
| MIME Type | `application/zip` |
| ุงูุชูุฑุงุฑ | ููููุน (ููุณ ุงูุงุณู) |

#### ูุซุงู ุงูุทูุจ:

```bash
curl -X POST "https://api.example.com/api/backups/upload" \
  -H "Authorization: Bearer {token}" \
  -F "file=@/path/to/backup.zip"
```

#### ุงูุงุณุชุฌุงุจุงุช:

| ุงูุญุงูุฉ | ุงูููุฏ | ุงูุฑุณุงูุฉ |
|--------|-------|---------|
| ูุฌุงุญ | 200 | `{"success": true, "message": "Backup uploaded successfully.", "file_name": "..."}` |
| ููู ูุทููุจ | 422 | Validation error |
| ุงูุชุฏุงุฏ ุฎุงุทุฆ | 422 | `File must be a zip archive.` |
| ููู ููุฌูุฏ | 409 | `A backup file with this name already exists.` |
| ุฎุทุฃ | 500 | `Failed to upload backup.` |

#### ุงูููุงุญุธุงุช:
- โ ูุชู ุชุณุฌูู ุงูุฑูุน ูู `backup_histories`
- โ ูููุน ุงููุชุงุจุฉ ููู ูููุงุช ููุฌูุฏุฉ
- โ ูุญูุธ ูู ููุณ ูุฌูุฏ ุงููุณุฎ ุงูุชููุงุฆูุฉ

---

### 5๏ธโฃ ุงุณุชุฑุฌุงุน ูุณุฎุฉ ุงุญุชูุงุทูุฉ (Restore)

#### ุงููุนูููุงุช ุงูุฃุณุงุณูุฉ:

| ุงูุนูุตุฑ | ุงููููุฉ |
|--------|--------|
| **Endpoint** | `POST /api/backups/restore` |
| **Authentication** | ูุทููุจ (Admin only) |
| **Controller Method** | `BackupController::restore()` |
| **ุงูููู** | `app/Http/Controllers/BackupController.php:153-326` |

#### ุงููุนุงููุงุช (Parameters):

| ุงููุนุงูู | ุงูููุน | ูุทููุจ | ุงููุตู |
|---------|-------|-------|-------|
| `file_name` | string | โ | ุงุณู ููู ุงููุณุฎุฉ ููุงุณุชุฑุฌุงุน |

#### ูุฑุงุญู ุงูุงุณุชุฑุฌุงุน:

```
1. ุงูุชุญูู ูู ุงุณู ุงูููู (Validation)
     โ
2. ุฅูุดุงุก ูุณุฎุฉ ููุงุฆูุฉ (Pre-restore Backup)
     โ
3. ุฏุฎูู ูุถุน ุงูุตูุงูุฉ (Maintenance Mode)
     โ
4. ูุชุญ ูุงุณุชุฎุฑุงุฌ ููู ZIP
     โ
5. ุงุณุชุนุงุฏุฉ storage/app/public
     โ
6. ุงุณุชูุฑุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช (SQL Import)
     โ
7. ูุณุญ ุงูู Cache
     โ
8. ุงูุฎุฑูุฌ ูู ูุถุน ุงูุตูุงูุฉ
     โ
9. ุชูุธูู ุงููููุงุช ุงููุคูุชุฉ
```

#### ูุฎุทุท ุงูุงุณุชุฑุฌุงุน:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    Restore Process                          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  โโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโ  โ
โ  โ  Validate    โ -> โ  Pre-Backup  โ -> โ  Enter       โ  โ
โ  โ  File Name   โ    โ  (Safety)    โ    โ  Maintenance โ  โ
โ  โโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโ  โ
โ                                                 โ           โ
โ  โโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโ  โ
โ  โ  Clear Cache โ <- โ  Import DB   โ <- โ  Restore     โ  โ
โ  โ  & Exit      โ    โ  (SQL)       โ    โ  Files       โ  โ
โ  โโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโ  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

#### ูุซุงู ุงูุทูุจ:

```bash
curl -X POST "https://api.example.com/api/backups/restore" \
  -H "Authorization: Bearer {token}" \
  -H "Content-Type: application/json" \
  -d '{"file_name": "2026-01-05-02-00-00.zip"}'
```

#### ุงูุงุณุชุฌุงุจุงุช:

| ุงูุญุงูุฉ | ุงูููุฏ | ุงูุฑุณุงูุฉ |
|--------|-------|---------|
| ูุฌุงุญ | 200 | `{"success": true, "message": "Backup restored successfully"}` |
| ุงุณู ูุงุฑุบ | 400 | `File name is required` |
| ุงุณู ุบูุฑ ุตุงูุญ | 422 | `Invalid file name` |
| ุบูุฑ ููุฌูุฏ | 404 | `Backup file not found` |
| ZipArchive ููููุฏ | 500 | `ZipArchive extension is missing` |
| ูุดู ุงููุณุฎุฉ ุงูููุงุฆูุฉ | 500 | `ูุดู ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ ููุงุฆูุฉ...` |
| ุฎุทุฃ ุนุงู | 500 | ุฑุณุงูุฉ ุงูุฎุทุฃ |

#### ุขููุฉ ุงูู Rollback:

```php
// ูู ุญุงูุฉ ุงููุดู ุจุนุฏ ุชุจุฏูู ุงููููุงุช:
if ($filesSwapped && $oldPublicPath) {
    // ูุญุงููุฉ ุงุณุชุนุงุฏุฉ ุงููููุงุช ุงูุฃุตููุฉ
    $this->deleteDirectory($livePublicPath);
    @rename($oldPublicPath, $livePublicPath);
}
```

#### ุงูููุงุญุธุงุช:
- โ **ูุณุฎุฉ ููุงุฆูุฉ ุชููุงุฆูุฉ** ูุจู ุงูุงุณุชุฑุฌุงุน
- โ **ูุถุน ุงูุตูุงูุฉ** ูุญูุงูุฉ ุงููููุน ุฃุซูุงุก ุงูุนูููุฉ
- โ **Rollback ุชููุงุฆู** ูู ุญุงูุฉ ุงููุดู
- โ๏ธ ูุชุทูุจ `ZipArchive` extension
- โ๏ธ ูุชุทูุจ `mysql` binary ูู PATH ุฃู ูุณุงุฑ ูุญุฏุฏ ูู config

---

### 6๏ธโฃ ุนุฑุถ ุงูุณุฌู (History)

#### ุงููุนูููุงุช ุงูุฃุณุงุณูุฉ:

| ุงูุนูุตุฑ | ุงููููุฉ |
|--------|--------|
| **Endpoint** | `GET /api/backups/history` |
| **Authentication** | ูุทููุจ (Admin only) |
| **Controller Method** | `BackupController::history()` |
| **ุงูููู** | `app/Http/Controllers/BackupController.php:473-477` |

#### ูุซุงู ุงูุทูุจ:

```bash
curl -X GET "https://api.example.com/api/backups/history" \
  -H "Authorization: Bearer {token}"
```

#### ุงูุงุณุชุฌุงุจุฉ:

```json
[
  {
    "id": 1,
    "type": "create",
    "status": "success",
    "file_name": "Laravel/2026-01-05-02-00-00.zip",
    "file_size": 131500000,
    "message": "Backup created successfully.",
    "user_id": null,
    "created_at": "2026-01-05T02:00:15.000000Z",
    "updated_at": "2026-01-05T02:00:15.000000Z"
  },
  {
    "id": 2,
    "type": "restore",
    "status": "success",
    "file_name": "2026-01-02-02-00-00.zip",
    "message": "Backup restored successfully.",
    "user_id": 1,
    "created_at": "2026-01-05T10:30:00.000000Z",
    "updated_at": "2026-01-05T10:30:00.000000Z"
  }
]
```

#### ุงูููุงุญุธุงุช:
- โ ูุนุฑุถ ุขุฎุฑ 50 ุณุฌู
- โ ูุฑุชุจ ูู ุงูุฃุญุฏุซ ููุฃูุฏู ุจ `latest()`

---

## โฐ ุงูุฌุฏููุฉ ุงูุชููุงุฆูุฉ

### ุงูููู: `routes/console.php`

| ุงูุฃูุฑ | ุงูุชูููุช | ุงููุตู |
|-------|---------|-------|
| `backup:run` | `0 2 */3 * *` | ูู 3 ุฃูุงู ุงูุณุงุนุฉ 2:00 ุตุจุงุญุงู |
| `backup:clean` | `03:00` ููููุงู | ุชูุธูู ุงููุณุฎ ุงููุฏููุฉ |
| `backup:monitor` | `04:00` ููููุงู | ูุญุต ุตุญุฉ ุงููุณุฎ |

### ููุฏ ุงูุฌุฏููุฉ:

```php
// ุชุดุบูู ุงููุณุฎ ุงูุงุญุชูุงุทู ูู 3 ุฃูุงู ุงูุณุงุนุฉ 2 ุตุจุงุญุงู
Schedule::command('backup:run')->cron('0 2 */3 * *');

// ุชูุธูู ุงููุณุฎ ุงููุฏููุฉ ููููุงู ุงูุณุงุนุฉ 3 ุตุจุงุญุงู
Schedule::command('backup:clean')->dailyAt('03:00');

// ูุฑุงูุจุฉ ุญุงูุฉ ุงููุณุฎ ููููุงู ุงูุณุงุนุฉ 4 ุตุจุงุญุงู
Schedule::command('backup:monitor')->dailyAt('04:00');
```

### ูุชุทูุจุงุช ุงูุชุดุบูู:

```bash
# ูุฌุจ ุชุดุบูู Laravel Scheduler ูู Crontab:
* * * * * cd /path-to-project && php artisan schedule:run >> /dev/null 2>&1
```

---

## โ๏ธ ุฅุนุฏุงุฏุงุช ุงูู Backup

### ุงูููู: `config/backup.php`

### ุงููุญุชูู ุงููุถูู ูู ุงููุณุฎุฉ:

| ุงูุนูุตุฑ | ุงููููุฉ | ุงูููุงุญุธุงุช |
|--------|--------|-----------|
| **ุงููููุงุช** | `storage/app/public` | ุตูุฑ ููุฑููุงุช ุงููุณุชุฎุฏููู |
| **ูุงุนุฏุฉ ุงูุจูุงูุงุช** | MySQL | ุงูุงุชุตุงู ุงูุงูุชุฑุงุถู |

### ุงููููุงุช ุงููุณุชุซูุงุฉ:

```php
'exclude' => [
    '.env',
    '.env.example',
    '.env.testing',
    'auth.json',
    'vendor',
    'node_modules',
    'storage/framework',
    'storage/logs',
    'public/hot',
    'storage/oauth-private.key',
    'storage/oauth-public.key',
]
```

### ููุงู ุงูุชุฎุฒูู:

| ุงููุฑุต | ุงูุญุงูุฉ | ุงูุดุฑุท |
|-------|--------|-------|
| `local` | โ ููุนู ุฏุงุฆูุงู | - |
| `s3` | ูุดุฑูุท | `BACKUP_TO_S3=true` + ุฅุนุฏุงุฏุงุช AWS |

### ูุชุบูุฑุงุช ุงูุจูุฆุฉ ุงููุทููุจุฉ ููู S3:

```env
BACKUP_TO_S3=true
AWS_BUCKET=your-bucket-name
AWS_DEFAULT_REGION=your-region
AWS_ACCESS_KEY_ID=your-key
AWS_SECRET_ACCESS_KEY=your-secret
```

### ุฅุนุฏุงุฏุงุช ุงูุชุดููุฑ:

```php
'password' => env('BACKUP_ARCHIVE_PASSWORD'),
'encryption' => 'default', // ZipArchive::EM_AES_256
```

### ุณูุงุณุฉ ุงูุชูุธูู:

```php
'default_strategy' => [
    'keep_all_backups_for_days' => 30,
    'keep_daily_backups_for_days' => 0,
    'keep_weekly_backups_for_weeks' => 0,
    'keep_monthly_backups_for_months' => 0,
    'keep_yearly_backups_for_years' => 0,
    'delete_oldest_backups_when_using_more_megabytes_than' => 5000,
]
```

### ูุญุต ุงูุตุญุฉ:

```php
'health_checks' => [
    MaximumAgeInDays::class => 5,       // ุฃูุตู ุนูุฑ ูููุณุฎุฉ: 5 ุฃูุงู
    MaximumStorageInMegabytes::class => 5000, // ุฃูุตู ุญุฌู: 5GB
]
```

---

## ๐ก ูุธุงู ุชุณุฌูู ุงูุฃุญุฏุงุซ

### ุงูููู: `app/Listeners/BackupEventSubscriber.php`

### ุงูุฃุญุฏุงุซ ุงููุฏุนููุฉ:

| ุงูุญุฏุซ | ุงูููุน | ุงูุญุงูุฉ |
|-------|-------|--------|
| `BackupWasSuccessful` | `create` | `success` |
| `BackupHasFailed` | `create` | `failed` |
| `CleanupWasSuccessful` | `clean` | `success` |
| `CleanupHasFailed` | `clean` | `failed` |
| `HealthyBackupWasFound` | `monitor` | `success` |
| `UnhealthyBackupWasFound` | `monitor` | `failed` |

### ุงูุชุณุฌูู ูู AppServiceProvider:

```php
// app/Providers/AppServiceProvider.php
Event::subscribe(BackupEventSubscriber::class);
```

---

## ๐๏ธ ูููุฐุฌ ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ุฌุฏูู: `backup_histories`

```sql
CREATE TABLE backup_histories (
    id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    type ENUM('create', 'restore', 'clean', 'monitor', 'upload', 'queued'),
    status ENUM('started', 'success', 'failed', 'queued'),
    file_name VARCHAR(255) NULL,
    file_size BIGINT NULL,
    message TEXT NULL,
    user_id BIGINT UNSIGNED NULL,
    created_at TIMESTAMP NULL,
    updated_at TIMESTAMP NULL
);
```

### ูููุฐุฌ Eloquent:

```php
// app/Models/BackupHistory.php
class BackupHistory extends Model
{
    protected $fillable = [
        'type',
        'status',
        'file_name',
        'file_size',
        'message',
        'user_id',
    ];
}
```

---

## ๐ ููุฎุต ููุงุท ุงูููุงูุฉ (API Endpoints Summary)

| ุงูุทุฑููุฉ | ุงููุณุงุฑ | ุงููุธููุฉ | ุงููุตู |
|---------|--------|---------|-------|
| `GET` | `/api/backups` | `index()` | ูุงุฆูุฉ ุงููุณุฎ ุงููุชุงุญุฉ |
| `GET` | `/api/backups/history` | `history()` | ุณุฌู ุงูุนูููุงุช |
| `GET` | `/api/backups/download` | `download()` | ุชุญููู ูุณุฎุฉ |
| `POST` | `/api/backups/create` | `create()` | ุฅูุดุงุก ูุณุฎุฉ ุฌุฏูุฏุฉ |
| `POST` | `/api/backups/upload` | `upload()` | ุฑูุน ูุณุฎุฉ ุฎุงุฑุฌูุฉ |
| `POST` | `/api/backups/restore` | `restore()` | ุงุณุชุฑุฌุงุน ูุณุฎุฉ |

---

## ๐ก ููุงุญุธุงุช ูุชูุตูุงุช

### โ ููุงุท ุงูููุฉ:

1. **ูุธุงู ูุชูุงูู** ูุบุทู ุฌููุน ุงูุนูููุงุช ุงูุฃุณุงุณูุฉ
2. **ูุณุฎุฉ ููุงุฆูุฉ ุชููุงุฆูุฉ** ูุจู ุงูุงุณุชุฑุฌุงุน
3. **ุชุณุฌูู ุดุงูู** ูุฌููุน ุงูุนูููุงุช
4. **ุฏุนู ุงูู Queue** ููุนูููุงุช ุงูุทูููุฉ
5. **Rollback ุชููุงุฆู** ูู ุญุงูุฉ ุงููุดู
6. **ุฏุนู ุงูุชุดููุฑ** ุงุฎุชูุงุฑู
7. **ุฏุนู S3** ูุดุฑูุท

### โ๏ธ ููุงุท ููุชุญุณูู:

1. **ุญุฐู ุงููุณุฎ:** ูุง ููุฌุฏ endpoint ูุญุฐู ูุณุฎุฉ ูุญุฏุฏุฉ ูุฏููุงู
2. **ุงูุชุญูู ูู ุงููุญุชูู:** ูุง ููุฌุฏ endpoint ููุชุญูู ูู ูุญุชูู ุงููุณุฎุฉ ูุจู ุงูุงุณุชุฑุฌุงุน
3. **ุงูุฅุดุนุงุฑุงุช:** ุงูุฅุดุนุงุฑุงุช ูุนุทูุฉ (ุชุณุชุฎุฏู `mail` ููู ุจุฅูููู ุงูุชุฑุงุถู)
4. **ุตูุงุญูุงุช ูููุตูุฉ:** ูููู ุฅุถุงูุฉ ุตูุงุญูุงุช ูููุตูุฉ (ูุซู `backup:restore`)
5. **Progress Tracking:** ูุง ููุฌุฏ ุชุชุจุน ูุชูุฏู ุงูุนูููุงุช ุงูุทูููุฉ

### ๐ง ูุชุทูุจุงุช ุงูุชุดุบูู:

- โ PHP Extension: `ZipArchive`
- โ MySQL binary ูู PATH (ููุงุณุชุฑุฌุงุน)
- โ Queue Worker ููุฏ ุงูุชุดุบูู
- โ Laravel Scheduler ูู Crontab
- โ ูุณุงุญุฉ ุชุฎุฒูู ูุงููุฉ

---

## ๐ ุงููุฑุงุฌุน

- [Spatie Laravel Backup Documentation](https://spatie.be/docs/laravel-backup)
- [Laravel Queue Documentation](https://laravel.com/docs/queues)
- [Laravel Task Scheduling](https://laravel.com/docs/scheduling)

---

*ูุฐุง ุงูุชูุฑูุฑ ุชู ุฅูุดุงุคู ุชููุงุฆูุงู ุจูุงุกู ุนูู ุชุญููู ุงูููุฏ ุงููุตุฏุฑู ูููุดุฑูุน.*
